<!-- Method 1 (using django utility -->
<form action="" method="post" class="ajax reload">
    {% csrf_token %}

    {{form.as_p}}

    <button type="submit">Submit</button>
<form>

    
<!-- Method 2 (looping over form fields) -->
<form action="" method="post" class="ajax reload">
    {% csrf_token %}

    {% for field in form %}
        <div class="form-group">
            {{ field.errors }}
            {{ field.label_tag }} {{ field }}
            {% if field.help_text %}
                <p class="help">{{ field.help_text|safe }}</p>
            {% endif %}
        </div>
    {% endfor %}
    
    <button type="submit">Submit</button>
<form>


<!-- Method 3 (call each form fields)-->
<form action="" method="post" class="ajax reload">
    {% csrf_token %}

    <div class="form-group">
	    <label for="{{form.name.id_for_label}}">{{form.name.label}}</label>
	    {{form.name}}
	</div>

	<div class="form-group">
	    <label for="{{form.phone.id_for_label}}">{{form.phone.label}}</label>
	    {{form.phone}}
	</div>

	<div class="form-group">
	    <label for="{{form.place.id_for_label}}">{{form.place.label}}</label>
	    {{form.place}}
	</div>

	<div class="form-group">
	    <label for="{{form.email.id_for_label}}">{{form.email.label}}</label>
	    {{form.email}}
	</div>

	<div class="form-group">
	    <label for="{{form.message.id_for_label}}">{{form.message.label}}</label>
	    {{form.message}}
	</div>

	<div class="form-group">
	    <button type="submit">Submit</button>
	</div>
<form>
    

<!-- Beautifying Response via ajax and sweetalert2 -->
{% block javascript %}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9.15.3/dist/sweetalert2.all.min.js"></script>
    <script>
        $(document).on('submit', 'form.ajax', function(e) {
            e.preventDefault();
            var $this = $(this);
            var data = new FormData(this);
            var action_url = $this.attr('action');
            var reset = $this.hasClass('reset');
            var reload = $this.hasClass('reload');
            var redirect = $this.hasClass('redirect');
            var redirect_url = $this.attr('data-redirect');

            $.ajax({
                url: action_url,
                type: 'POST',
                data: data,
                cache: false,
                contentType: false,
                processData: false,
                dataType: "json",

                success: function(data) {

                    var status = data.status;
                    var title = data.title;
                    var message = data.message;
                    var pk = data.pk;

                    if (status == "true") {
                        if (title) {
                            title = title;
                        } else {
                            title = "Success";
                        }

                        Swal.fire({
                            title: title,
                            html: message,
                            icon: 'success',
                        }).then(function() {
                            if (redirect) {
                                window.location.href = redirect_url;
                            }
                            if (reload) {
                                window.location.reload();
                            }
                            if (reset) {
                                window.location.reset();
                            }
                        });

                    } else {
                        if (title) {
                            title = title;
                        } else {
                            title = "An Error Occurred";
                        }
                        Swal.fire({
                            title: title,
                            html: message,
                            icon: "error"
                        });

                    }
                },
                error: function(data) {
                    var title = "An error occurred";
                    var message = "something went wrong";
                    Swal.fire({
                        title: title,
                        html: message,
                        icon: "error"
                    });
                }
            });
        });
    </script>
{% endblock javascript %}
